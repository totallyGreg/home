#!/usr/bin/env bash

function setup_macos {
  # Useful inspiration
  # - https://github.com/mathiasbynens/dotfiles/blob/master/.macos
  # - https://ss64.com/osx/syntax-defaults.html

  # Close any open System Preferences panes, to prevent them from overriding
  # settings we’re about to change
  osascript -e 'tell application "System Preferences" to quit'

  # Disable automatic capitalization as it’s annoying when typing code
  defaults write NSGlobalDomain NSAutomaticCapitalizationEnabled -bool false

  # Disable smart dashes as they’re annoying when typing code
  defaults write NSGlobalDomain NSAutomaticDashSubstitutionEnabled -bool false

  # Trackpad: enable tap to click for this user and for the login screen
  defaults write com.apple.driver.AppleBluetoothMultitouch.trackpad Clicking -bool true
  defaults -currentHost write NSGlobalDomain com.apple.mouse.tapBehavior -int 1
  defaults write NSGlobalDomain com.apple.mouse.tapBehavior -int 1

  # Use scroll gesture with the Ctrl (^) modifier key to zoom
  # Requires Terminal.app full disk access: System Preferences -> Privacy -> Full Disk Access
  defaults write com.apple.universalaccess closeViewScrollWheelToggle -bool true
  defaults write com.apple.universalaccess HIDScrollZoomModifierMask -int 262144
  # Follow the keyboard focus while zoomed in
  defaults write com.apple.universalaccess closeViewZoomFollowsFocus -bool true

  # Disable press-and-hold for keys in favor of key repeat
  defaults write NSGlobalDomain ApplePressAndHoldEnabled -bool false

  # Set a blazingly fast keyboard repeat rate
  defaults write NSGlobalDomain KeyRepeat -int 2
  defaults write NSGlobalDomain InitialKeyRepeat -int 15

  ###############################################################################
  # Finder                                                                      #
  ###############################################################################
  # Show the ~/Library folder
  chflags nohidden ~/Library # && xattr -d com.apple.FinderInfo ~/Library

  ###############################################################################
  # Dock, Dashboard, and hot corners                                            #
  ###############################################################################
  # Automatically hide and show the Dock
  defaults write com.apple.dock autohide -bool true

  # move Dock to left side of screen
  defaults write com.apple.dock orientation left

  # Turn on Magnifcation
  defaults write com.apple.dock magnification -boolean TRUE

  # Make Dock icons of hidden applications translucent
  defaults write com.apple.dock showhidden -bool true

  # Hot corners
  # Possible values:
  #  0: no-op
  #  2: Mission Control
  #  3: Show application windows
  #  4: Desktop
  #  5: Start screen saver
  #  6: Disable screen saver
  #  7: Dashboard
  # 10: Put display to sleep
  # 11: Launchpad
  # 12: Notification Center
  # 13: Lock Screen
  # Top left screen corner → Mission Control
  # defaults write com.apple.dock wvous-tl-corner -int 2
  # defaults write com.apple.dock wvous-tl-modifier -int 0
  # Top right screen corner → Control ^Desktop
  defaults write com.apple.dock wvous-tr-corner -int 4
  defaults write com.apple.dock wvous-tr-modifier -int 262144
  # Bottom left screen corner → Start screen saver
  defaults write com.apple.dock wvous-bl-corner -int 5
  defaults write com.apple.dock wvous-bl-modifier -int 0
}

function setup_terminal {
  echo "Install Terminal Profiles"
  open "${HOME}/.config/Totally Dark.terminal"
  open "${HOME}/.config/Totally Light.terminal"
  defaults write com.apple.terminal "Default Window Settings" "Totally Dark"
  echo "Setup Solarized Colors: Terminal.app, Apple Color Palette, dircolors"
}

function setup_python {
  # from https://opensource.com/article/19/5/python-3-default-mac#what-to-do
  brew install pyenv 
  # determine python_version
  python_version=3.8.3
  pyenv install $python_version
  pyenv global $python_version
}
setup_macos
setup_terminal


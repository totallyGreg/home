#!/usr/bin/perl
#
# Encode/decode numeric HTML entities

sub decodeEntity ($) {
	if ($_[0] =~ /^x([0-9a-fA-F]+)/) {
		return chr(hex($1));
	}
	else {
		return chr($_[0]);
	}
}

if ($ENV{"PIPE_REVERSE_TRANSFORM"}) {
	while (<>) {
		s/&#(\w+);/decodeEntity($1)/eg;
		print;
	}
}
else {
	while (<>) {
		chomp;
		for ($i=0; $i < length($_); $i++) {
			printf "&#x%x;", ord(substr($_, $i, 1));
		}
		print "\n";
	}
}
